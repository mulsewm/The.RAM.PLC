(()=>{var e={};e.id=690,e.ids=[690],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},24408:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>f,routeModule:()=>c,serverHooks:()=>h,workAsyncStorage:()=>l,workUnitAsyncStorage:()=>m});var s={};r.r(s),r.d(s,{GET:()=>u,POST:()=>d});var a=r(96559),n=r(48088),i=r(37719),o=r(32190),p=r(79464);async function u(e,{params:t}){try{let e=t.id;if(!await p.z.partnershipApplication.findUnique({where:{id:e},select:{id:!0}}))return o.NextResponse.json({error:"Partnership application not found"},{status:404});let r=await p.z.attachment.findMany({where:{applicationId:e},include:{uploadedBy:{select:{id:!0,name:!0,email:!0}}},orderBy:{uploadedAt:"desc"}});return o.NextResponse.json({attachments:r})}catch(e){return console.error("Error fetching attachments:",e),o.NextResponse.json({error:"Internal Server Error"},{status:500})}}async function d(e,{params:t}){try{let r=t.id,s=await e.formData(),a=s.get("file"),n=s.get("description")||"",i=s.get("userId");if(!a)return o.NextResponse.json({error:"No file uploaded"},{status:400});if(!i)return o.NextResponse.json({error:"User ID is required"},{status:400});if(!["application/pdf","image/jpeg","image/png","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(a.type))return o.NextResponse.json({error:"Invalid file type"},{status:400});if(a.size>5242880)return o.NextResponse.json({error:"File too large (max 5MB)"},{status:400});if(!await p.z.partnershipApplication.findUnique({where:{id:r},select:{id:!0}}))return o.NextResponse.json({error:"Partnership application not found"},{status:404});if(!await p.z.user.findUnique({where:{id:i},select:{id:!0}}))return o.NextResponse.json({error:"User not found"},{status:400});let u=`/uploads/${Date.now()}-${a.name}`,d=await p.z.attachment.create({data:{fileName:a.name,fileType:a.type,fileSize:a.size,description:n,filePath:u,userId:i,applicationId:r},include:{uploadedBy:{select:{id:!0,name:!0,email:!0}}}});return await p.z.partnershipApplication.update({where:{id:r},data:{updatedAt:new Date}}),o.NextResponse.json({success:!0,attachment:d})}catch(e){return console.error("Error uploading attachment:",e),o.NextResponse.json({error:"Internal Server Error"},{status:500})}}let c=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/partnerships/[id]/attachments/route",pathname:"/api/partnerships/[id]/attachments",filename:"route",bundlePath:"app/api/partnerships/[id]/attachments/route"},resolvedPagePath:"/Users/mulsewsmba/Downloads/the.RAM.plc/app/api/partnerships/[id]/attachments/route.ts",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:l,workUnitAsyncStorage:m,serverHooks:h}=c;function f(){return(0,i.patchFetch)({workAsyncStorage:l,workUnitAsyncStorage:m})}},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},79464:(e,t,r)=>{"use strict";r.d(t,{z:()=>a});var s=r(96330);let a=global.prisma||new s.PrismaClient({log:["error"]})},96330:e=>{"use strict";e.exports=require("@prisma/client")},96487:()=>{}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[719,580],()=>r(24408));module.exports=s})();