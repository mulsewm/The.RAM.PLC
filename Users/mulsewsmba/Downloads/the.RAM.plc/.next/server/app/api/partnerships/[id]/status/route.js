(()=>{var e={};e.id=930,e.ids=[930],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},46873:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>m,routeModule:()=>l,serverHooks:()=>w,workAsyncStorage:()=>x,workUnitAsyncStorage:()=>h});var s={};r.r(s),r.d(s,{PUT:()=>c});var a=r(96559),n=r(48088),i=r(37719),o=r(32190),u=r(45697),p=r(79464);let d=u.z.object({status:u.z.enum(["NEW","UNDER_REVIEW","APPROVED","REJECTED","ONBOARDING"]),notes:u.z.string().optional(),userId:u.z.string()});async function c(e,{params:t}){try{let r=t.id,s=await e.json(),a=d.parse(s),n=await p.z.partnershipApplication.findUnique({where:{id:r}});if(!n)return o.NextResponse.json({error:"Partnership application not found"},{status:404});let i=await p.z.user.findUnique({where:{id:a.userId}});if(!i)return o.NextResponse.json({error:"User not found"},{status:400});let u=await p.z.$transaction(async e=>{let t=await e.statusHistory.create({data:{previousStatus:n.status,newStatus:a.status,notes:a.notes,userId:i.id,applicationId:r},include:{changedBy:{select:{id:!0,name:!0,email:!0}}}}),s=await e.partnershipApplication.update({where:{id:r},data:{status:a.status,updatedAt:new Date},include:{statusHistory:{include:{changedBy:{select:{id:!0,name:!0,email:!0}}},orderBy:{changedAt:"desc"},take:5}}});return{statusHistory:t,updatedApplication:s}});return o.NextResponse.json({success:!0,application:u.updatedApplication,statusHistory:u.statusHistory})}catch(e){if(e instanceof u.z.ZodError)return o.NextResponse.json({errors:e.errors},{status:400});return console.error("Error updating status:",e),o.NextResponse.json({error:"Internal Server Error"},{status:500})}}let l=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/partnerships/[id]/status/route",pathname:"/api/partnerships/[id]/status",filename:"route",bundlePath:"app/api/partnerships/[id]/status/route"},resolvedPagePath:"/Users/mulsewsmba/Downloads/the.RAM.plc/app/api/partnerships/[id]/status/route.ts",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:x,workUnitAsyncStorage:h,serverHooks:w}=l;function m(){return(0,i.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:h})}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},79464:(e,t,r)=>{"use strict";r.d(t,{z:()=>a});var s=r(96330);let a=global.prisma||new s.PrismaClient({log:["error"]})},96330:e=>{"use strict";e.exports=require("@prisma/client")},96487:()=>{}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[719,580,697],()=>r(46873));module.exports=s})();