(()=>{var e={};e.id=381,e.ids=[381],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},6752:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>g,routeModule:()=>m,serverHooks:()=>x,workAsyncStorage:()=>h,workUnitAsyncStorage:()=>y});var s={};r.r(s),r.d(s,{GET:()=>c,PUT:()=>l});var a=r(96559),n=r(48088),i=r(37719),o=r(32190),p=r(45697),u=r(79464);let d=p.z.object({status:p.z.enum(["NEW","UNDER_REVIEW","APPROVED","REJECTED","ONBOARDING"]).optional(),notes:p.z.array(p.z.object({content:p.z.string(),createdBy:p.z.string().optional()})).optional(),attachments:p.z.array(p.z.object({fileName:p.z.string(),fileType:p.z.string(),fileSize:p.z.number(),description:p.z.string().optional(),filePath:p.z.string()})).optional()});async function c(e,{params:t}){try{let e=t.id,r=await u.z.partnershipApplication.findUnique({where:{id:e},include:{statusHistory:{include:{changedBy:{select:{id:!0,name:!0,email:!0}}},orderBy:{changedAt:"desc"}},notes:{include:{createdBy:{select:{id:!0,name:!0,email:!0}}},orderBy:{createdAt:"desc"}},attachments:{include:{uploadedBy:{select:{id:!0,name:!0,email:!0}}},orderBy:{uploadedAt:"desc"}}}});if(!r)return o.NextResponse.json({error:"Partnership application not found"},{status:404});return o.NextResponse.json(r)}catch(e){return console.error("Error fetching application:",e),o.NextResponse.json({error:"Internal Server Error"},{status:500})}}async function l(e,{params:t}){try{let r=t.id,s=await e.json(),a=d.parse(s),n=await u.z.partnershipApplication.findUnique({where:{id:r}});if(!n)return o.NextResponse.json({error:"Partnership application not found"},{status:404});let i=await u.z.user.findFirst({where:{email:"system@theram.plc"}});i||(i=await u.z.user.create({data:{name:"System",email:"system@theram.plc",role:"ADMIN"}}));let p=await u.z.partnershipApplication.update({where:{id:r},data:{...a.status&&{status:a.status,statusHistory:{create:{previousStatus:n.status,newStatus:a.status,notes:"Status updated via API",userId:i.id}}},updatedAt:new Date},include:{statusHistory:{include:{changedBy:{select:{id:!0,name:!0}}},orderBy:{changedAt:"desc"}}}});return o.NextResponse.json(p)}catch(e){if(e instanceof p.z.ZodError)return o.NextResponse.json({errors:e.errors},{status:400});return console.error("Error updating application:",e),o.NextResponse.json({error:"Internal Server Error"},{status:500})}}let m=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/partnerships/[id]/route",pathname:"/api/partnerships/[id]",filename:"route",bundlePath:"app/api/partnerships/[id]/route"},resolvedPagePath:"/Users/mulsewsmba/Downloads/the.RAM.plc/app/api/partnerships/[id]/route.ts",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:h,workUnitAsyncStorage:y,serverHooks:x}=m;function g(){return(0,i.patchFetch)({workAsyncStorage:h,workUnitAsyncStorage:y})}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},79464:(e,t,r)=>{"use strict";r.d(t,{z:()=>a});var s=r(96330);let a=global.prisma||new s.PrismaClient({log:["error"]})},96330:e=>{"use strict";e.exports=require("@prisma/client")},96487:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[719,580,697],()=>r(6752));module.exports=s})();